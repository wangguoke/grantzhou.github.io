---
layout: post
title: PostgreSQL æ¯å‘¨æ–°é—» 2019-7-24
---

### PostgreSQLæ¯å‘¨æ–°é—»#315 - 2019å¹´7æœˆ24æ—¥

![_config.yml]({{ site.baseurl }}/images/PostgresWeekly.png)

å¤‡æ³¨ï¼š[è‹±æ–‡åŸæ–‡åœ°å€](https://postgresweekly.com/issues/315)

![img](https://res.cloudinary.com/cpress/image/upload/w_1280,e_sharpen:60/v1563921627/twah9uwlfbt4ve2bn8s1.png)

## [å¾…å‘½ç”Ÿäº§ï¼šè¡¡é‡ä¸–ç•Œç¬¬äºŒå¤§åˆ†ç±»ç½‘ç«™](https://medium.com/avitotech/standby-in-production-scaling-application-in-second-largest-classified-site-in-the-world-97a79a1929de)

é˜¿ç»´æ‰˜æ˜¯ä¿„ç½—æ–¯æœ€å¤§çš„åˆ†ç±»å¹¿å‘Šç½‘ç«™ï¼Œå®ƒåœ¨100ä¸ªPostgresèŠ‚ç‚¹ä¸Šå­˜å‚¨äº†20TBçš„æ•°æ®ã€‚è¿™é‡Œå¸¦ä½ ä»å¹•åè¯¦ç»†åœ°äº†è§£ä»–ä»¬çš„Postgresé«˜å¯ç”¨æ€§è®¾ç½®ã€‚

`KONSTANTIN EVTEEV`

## [ä½¿ç”¨pg_qualstatså’ŒHypoPGçš„è‡ªåŠ¨ç´¢å¼•å»ºè®®](https://www.percona.com/blog/2019/07/22/automatic-index-recommendations-in-postgresql-using-pg_qualstats-and-hypopg/)

[HypoPG](https://github.com/HypoPG/hypopg)æ˜¯Postgresçš„æ‰©å±•ï¼Œç”¨äºåˆ›å»ºâ€œå‡æƒ³ç´¢å¼•â€ï¼Œæœ¬è´¨ä¸Šæ˜¯è™šæ‹Ÿç´¢å¼•ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æµ‹è¯•æŸä¸ªç´¢å¼•æ˜¯å¦èƒ½å¤Ÿæå‰æ”¹è¿›æŸ¥è¯¢ã€‚æœ¬æ–‡é€šè¿‡è‡ªåŠ¨æŸ¥æ‰¾å€¼å¾—åˆ›å»ºçš„ç´¢å¼•ï¼Œä½¿äº‹åŠ¡æ¨è¿›åˆ°ä¸‹ä¸€æ­¥ã€‚

`AVINASH VALLARAPU`

## [Chefçš„é¦–å¸­æŠ€æœ¯å®˜é€‰æ‹©StrongDM](https://www.strongdm.com/postgres-weekly/?utm_source=PGWeekly&utm_medium=email&utm_campaign=2019-07-22%20-%20%5BSELF%5D%20-%20%5BSDM%5D%20-%20%5BMID%5D)

Adam Jacobè¯´:â€œStrongDMæ¶ˆé™¤äº†ç»ˆç«¯ç”¨æˆ·è®¿é—®ä»–ä»¬éœ€è¦çš„ç³»ç»Ÿæ—¶å‘ç”Ÿçš„æ‘©æ“¦ã€‚â€é›¶ä¿¡ä»»è®¿é—®ä»»ä½•æ•°æ®åº“ã€æœåŠ¡å™¨æˆ–k8é›†ç¾¤ã€‚[ç‚¹å‡»è¿™é‡Œ](https://www.strongdm.com/postgres-weekly/?utm_source=PGWeekly&utm_medium=email&utm_campaign=2019-07-22%20-%20%5BSELF%5D%20-%20%5BSDM%5D%20-%20%5BMID%5D%20)å…è´¹è¯•ç”¨ã€‚

![img](https://copm.s3.amazonaws.com/975a5f60.png)

`STRONGDM`**èµåŠ©å•†**

## [ä¸è¦å¿˜è®°BRINç´¢å¼•çš„å¥½å¤„](https://www.percona.com/blog/2019/07/16/brin-index-for-postgresql-dont-forget-the-benefits/)ã€‚

BRINç´¢å¼•(å®ƒæä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¯ä»¥å°†ç´¢å¼•å€¼åˆ†ç»„ä¸ºâ€œèŒƒå›´â€)åœ¨Postgres 9.5ä¸­å¼•å…¥ï¼Œå¹¶å…·æœ‰ä¸€äº›ç‰¹å®šçš„ç”¨ä¾‹ã€‚è¿™ç¯‡æ–‡ç« æµ‹è¯•äº†ä¸€ç§ç¡®å®å¯ä»¥æä¾›å¸®åŠ©çš„æƒ…å†µã€‚

`JOBIN AUGUSTINE`

## [ä½¿ç”¨SQLå¯¹éšæœºç»“æœæ’åº](https://vladmihalcea.com/sql-order-by-random/)

è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ORDERä»¥å‡ ç§ç‰¹å®šäºæ•°æ®åº“çš„æ–¹å¼å¯¹è¡Œè¿›è¡Œéšæœºæ’åºï¼ŒåŒ…æ‹¬Postgresã€‚

`VLAD MIHALCEA`

## [åœ¨psqlè„šæœ¬ä¸­æ£€æŸ¥Postgresçš„ç‰ˆæœ¬](https://fluca1978.github.io/2019/07/18/CheckPostgreSQLVersionInScripts.html)

å‡è®¾æ‚¨æƒ³æ ¹æ®æ­£åœ¨è¿è¡Œçš„Postgresç‰ˆæœ¬è¿è¡Œä¸åŒçš„ä»£ç ã€‚ä½ å¯ä»¥çš„!

`LUCA FERRARI`

## [çŒ®ç»™å¹³å‡å’Œé«˜çº§ï¼ˆç”šè‡³æ›´å¤šï¼‰ç”¨æˆ·çš„PostgresæŠ€å·§](https://www.citusdata.com/blog/2019/07/17/postgres-tips-for-average-and-power-user/)

å¸Œæœ›ä½ å–œæ¬¢æˆ‘ä»¬ä»Šå¹´åœ¨ã€ŠPostgres Weeklyã€‹ä¸­æ”¶å½•çš„å„ç§â€œæœ¬å‘¨è¦è¯€â€ï¼Œä½†åœ¨è¿™é‡Œï¼ŒCraig Kerstiensè¿˜ä¼šå‘æ˜å‡ºæ›´å¤š:-)

`CRAIG KERSTIENS`

## [ä½¿ç”¨Datadogä¸»åŠ¨ç›‘æ§PostgreSQLæ€§èƒ½](https://www.datadoghq.com/postgres-monitoring/?utm_source=Advertisement&utm_medium=CooperPress&utm_campaign=CooperPress-PostgresWeeklyS)

é€šè¿‡å¯¹å»¶è¿Ÿå³°å€¼ã€é”™è¯¯ã€å¼‚å¸¸ç­‰å‘å‡ºå¯æ“ä½œçš„è­¦æŠ¥æ¥æ”¹è¿›PostgreSQLæ€§èƒ½ã€‚æ™ºèƒ½ç›‘æ§ä¸Datadog â€”â€”å…è´¹ä½¿ç”¨ã€‚

`DATADOG`**èµåŠ©å•†**

## [å¦‚ä½•å¤åˆ¶å‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹ï¼Ÿ](https://www.cybertec-postgresql.com/en/postgresql-how-are-functions-and-stored-procedures-replicated/)

ç®€è¦ä»‹ç»Postgresæ˜¯å¦‚ä½•å­˜å‚¨å‡½æ•°å’Œè¿‡ç¨‹çš„ï¼Œä»¥åŠè¿™äº›å‡½æ•°å’Œè¿‡ç¨‹æ˜¯å¦‚ä½•è¢«å¤åˆ¶çš„ã€‚

`HANS-JÃœRGEN SCHÃ–NIG`

## [Postgres Docker Containersçš„è¯ä¹¦è®¤è¯é…æ–¹](https://info.crunchydata.com/blog/ssl-certificate-authentication-postgresql-docker-containers)

äº†è§£å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªç®€å•çš„Docker Containersé…æ–¹è®¾ç½®åŸºäºPostgreSQLè¯ä¹¦çš„è®¤è¯ã€‚

`JONATHAN S. KATZ`

## ['Mysterious'backend_flush_afteré…ç½®è®¾ç½®](https://www.cybertec-postgresql.com/en/the-mysterious-backend_flush_after-configuration-setting/)

è¿™æ˜¯ä¸€ä¸ªéå¸¸ç‰¹åˆ«çš„è®¾ç½®ï¼Œé€‚ç”¨äºé‚£äº›å¸Œæœ›è·å¾—ä¸€äº›é¢å¤–æ€§èƒ½çš„æœåŠ¡å™¨æ“ä½œäººå‘˜(å¹¶ä¸”ä»…é€‚ç”¨äºé‚£äº›ä½¿ç”¨Linuxçš„æ“ä½œäººå‘˜)ã€‚

`KAAREL MOPPEL`

## [é…ç½®pgBackRestä»¥ä½¿ç”¨Amazon S3](https://pgstef.github.io/2019/07/19/pgbackrest_s3_configuration.html)

[pgBackRest](https://pgbackrest.org/)æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¤‡ä»½å’Œæ¢å¤å·¥å…·ï¼Œå¯ä»¥é…ç½®ä»¥ä½¿ç”¨AWS S3ã€‚

`STEFAN FERCOT`

# ğŸ’¡æœ¬å‘¨æç¤º

ç”±Gremlinæä¾›æ”¯æŒ

### ä½¿ç”¨ROLLUPè·å–èšåˆçš„æ•´ä½“ç»“æœè¡Œ

å¦‚æœè¦å°†ç»“æœåˆ†ç»„å¹¶èšåˆåœ¨ä¸€èµ·ï¼Œåˆ™ä½¿ç”¨GROUP BYä½œä¸ºä¸€ä¸ªå¸¸ç”¨æ–¹æ³•ï¼Œä½†ROLLUPæ˜¯å°‘æ•°æ¡æ¬¾ä¸­çš„ä¸€ä¸ªï¼Œå®ƒå¯ä»¥å¸®åŠ©æ‚¨é€šè¿‡è®©å¤šä¸ªé›†åˆåœ¨ä¸€ä¸ªå•å…ƒä¸­å°†äº‹ç‰©è½¬ç§»åˆ°å¦ä¸€ä¸ªç»´åº¦æŸ¥è¯¢ã€‚

è¿™æ˜¯ç°åœºæœ€ä½³æ¼”ç¤ºçš„åŠŸèƒ½ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¡¨å¹¶åŠ è½½ä¸€äº›ç¤ºä¾‹æ•°æ®ã€‚ä¸åŒå¹´ä»½ä¸åŒè¶³çƒé˜Ÿçš„å¾—åˆ†æ•°ï¼š

```
  CREATE TABLE goals (
  team TEXT, year INT, goals INT);

INSERT INTO goals VALUES
  ('USA', 2010, 5), ('USA', 2011, 3),
  ('USA', 2012, 12), ('ENG', 2010, 17),
  ('ENG', 2011, 9), ('ENG', 2012, 11);  
```

å¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾—æ¯é˜Ÿæ¯å¹´å¹³å‡è¿›çƒæ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š

```
SELECT team, ROUND(AVG(goals))
  FROM goals GROUP BY team;
```

ä½†æ˜¯ï¼Œå‡è®¾æˆ‘ä»¬ä¸ä»…å¸Œæœ›æŒ‰å›¢é˜Ÿåˆ†ç»„ï¼Œè¿˜å¸Œæœ›é€šè¿‡æ•´ä½“è¡¨æ ¼ï¼ˆå³æ²¡æœ‰ä¸“æ ï¼‰æ¥è·å¾—æ€»ä½“å¹³å‡ç›®æ ‡æ•°é‡ã€‚ æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š

```
SELECT team, ROUND(AVG(goals))
  FROM goals GROUP BY ROLLUP(team);
```

è¿™ç»™æˆ‘ä»¬å¸¦æ¥äº†å¦‚ä¸‹ç»“æœï¼š

```
  team | round
--------------
   ENG | 12
   USA | 7
 (null)| 10
```

é™¤æ­¤ä¹‹å¤–è¿˜æœ‰æ›´å¤šå†…å®¹ï¼Œæ‰€ä»¥è¯·äº«å—[æœ¬æ•™ç¨‹](http://www.postgresqltutorial.com/postgresql-rollup/)æ¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

æœ¬å‘¨çš„æç¤ºç”±[Gremlin](https://www.gremlin.com/?utm_medium=cpm&utm_source=PostgresWeekly&utm_content=20190724&utm_campaign=2019_Cooperpress)æä¾›ç»™æ‚¨ï¼Œè¿™ä¸ªå¹³å°å¯ä»¥é€šè¿‡è¿è¡Œåˆç†çš„Chaos Engineeringå®éªŒæ¥å¸®åŠ©æ‚¨æ„å»ºæ›´å…·å¼¹æ€§çš„è½¯ä»¶ã€‚ æ›´å¤šä¿¡æ¯è¯·è®¿é—®[gremlin.com](https://www.gremlin.com/?utm_medium=cpm&utm_source=PostgresWeekly&utm_content=20190724&utm_campaign=2019_Cooperpress)ã€‚

ğŸ—“  **å³å°†ä¸¾åŠçš„Postgresæ´»åŠ¨**  

â€¢ [PGConf.Brasil 2019](https://www.pgconf.com.br/2019/en/)(8æœˆ1-3æ—¥ï¼Œåœ£ä¿ç½—)â€”â€”ä¸ºæœŸä¸‰å¤©çš„ä¼šè®®ï¼ŒåŒ…æ‹¬è®²åº§ï¼Œæ•™ç¨‹ï¼Œè¯¾ç¨‹å’Œé—ªç”µè®²åº§ã€‚

â€¢ [PGDay Austria 2019](https://pgday.at/en/)ï¼ˆ9æœˆ6æ—¥ï¼Œ ç»´çº³Â·çº½æ–¯å¡”ç‰¹ï¼Œå¥¥åœ°åˆ©ï¼‰

â€¢ [PostgreSQL Conference Asia 2019](https://2019.pgconf.asia/)ï¼ˆ9æœˆ8-11æ—¥ï¼Œå·´å˜å²›ï¼Œå°åº¦å°¼è¥¿äºšï¼‰

â€¢ [PostgresConf South Africa 2019](https://postgresconf.org/conferences/SouthAfrica2019)ï¼ˆ10æœˆ8-9æ—¥ï¼Œçº¦ç¿°å†…æ–¯å ¡ï¼‰â€”â€”æä¾›ç»™ä½¿ç”¨Postgresçš„æ•°æ®åº“ç®¡ç†å’Œå¼€å‘äººå‘˜äº’ç›¸äº†è§£çš„æœºä¼šã€‚